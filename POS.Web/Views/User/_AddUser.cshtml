@using POS.Utilities.Services
@using POS.Utilities.ViewModel
@model UserViewModel
@{

    Layout = null;
    Model.UserTypes = UserServices.GetAllUserTypes();
    Model.Designations = UserServices.GetAllDesignations();
}

@using (Html.BeginForm("", "", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.Id)
    <div class="form-row">
        <div class="form-group col-md-6">
            <label class="col-form-label">User Name <b class="text-danger">*</b></label>
            @Html.TextBoxFor(m => m.UserName, new { @class = "form-control", placeholder = "Enter User Name ", @required = "true" })
        </div>

        <div class="form-group col-md-6">
            <label class="col-form-label">Password <b class="text-danger">*</b></label>
            @Html.PasswordFor(m => m.Password, new { @class = "form-control", placeholder = "Enter Password", @required = "true" })
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-12">
            <label class="col-form-label">Email <b class="text-danger">*</b></label>
            @Html.TextBoxFor(m => m.Email, new { type = "email", @class = "form-control", placeholder = "E.g john@domin.com ", @required = "true" })
        </div>


    </div>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label class="col-form-label">Full Name</label>
            @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", placeholder = "Enter Full Name ", @required = "true" })
        </div>
        <div class="form-group col-md-6">
            <label class="col-form-label">Father Name</label>
            @Html.TextBoxFor(m => m.FatherName, new { @class = "form-control", placeholder = "Enter Full Name ", @required = "true" })
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label class="col-form-label">CNIC</label>
            @Html.TextBoxFor(m => m.CNIC, new { @class = "form-control", placeholder = "Enter CNIC 14 Digit ", @required = "true" })
        </div>
        <div class="form-group col-md-6">
            <label class="col-form-label">Mobile</label>
            @Html.TextBoxFor(m => m.Mobile, new { @class = "form-control", placeholder = "Enter Mobile Number ", @required = "true" })
        </div>
    </div>
    <div class="form-row">
        <div class="form-group col-md-6">
            <label class="col-form-label">User Type <b class="text-danger">*</b></label>
            @Html.DropDownListFor(m => m.UserTypeId, new SelectList(Model.UserTypes, "Id", "Name"), new { @class = "form-control selectpicker", data_live_search = "true", data_hide_disabled = "true", title = "-- Select User Type --", @required = "true" })
        </div>
        <div class="form-group col-md-6">
            <label class="col-form-label">Designation <b class="text-danger">*</b></label>
            @Html.DropDownListFor(m => m.DesignationId, new SelectList(Model.Designations, "Id", "Name"), new { @class = "form-control selectpicker", data_live_search = "true", data_hide_disabled = "true", title = "-- Select Designation --", @required = "true" })
        </div>
    </div>
    <div class="modal-footer col-md-12">
        <div class="form-group">
            <button type="button" id="User" class="btn btn-primary"><span class="fa fa-edit"></span> Save</button>
            <button type="button" data-dismiss="modal" class="btn btn-dark"><span class="fa fa-remove"></span> Cancel</button>
        </div>
    </div>
}
<script>

    $("#User").click(function () {

        var id = $("#Id").val();
        var userName = $("#UserName").val();
        var password = $("#Password").val();
        var email = $("#Email").val();
        var fullName = $("#FullName").val();
        var fatherName = $("#FatherName").val();
        var cnic = $("#CNIC").val();
        var mobile = $("#Mobile").val();
        var userTypeId = $("#UserTypeId").val();
        var designationId = $("#DesignationId").val();
        debugger;
        if (userName == "" || email == "" || userTypeId == "" || designationId == "") {
            alertify.error("Fill required fields.");
            return;
        }
        else if (id == "0" && password == "") {
            alertify.error("Please Enter Password.");
            return;
        }
        else
        {
            var modelData = {
                Id: id,
                UserName: userName,
                Password: password,
                Email: email,
                FullName: fullName,
                FatherName: fatherName,
                CNIC: cnic,
                Mobile: mobile,
                UserTypeId: userTypeId,
                DesignationId: designationId,
            };
            startLoader();
            $.ajax({
                url: '@Url.Action("AddUser", "User")',
                contentType: 'application/json; charset=utf-8',
                type: "POST",
                data: JSON.stringify(modelData),
                datatype: "Json",
            }).done(function (res) {
                console.log(res);
                if (res == "Error" || res == "") {
                    alertify.error("Something went wrong");
                }
                else if (res == "Success") {
                    alertify.success("Update successfully");
                    location.reload();
                }
                stopLoader();
            });
        }
    });
</script>



